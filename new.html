<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Form</title>    
  <style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap');



:root{

    --primary-color: #F8F7FC;

    --secondary-color: #231E1E;

    --accent-color: #fa7f03;

}

*{

    padding: 0;

    margin: 0;

    box-sizing: border-box;

    font-family: 'Poppins', sans-serif;

}



body{

    position: relative;

    display: flex;

    justify-content: center;

    height: 100vh;

    background: var(--primary-color);

}



.registration-container{

    background: #ffffff;

    margin: auto;

    padding: 15px 25px;

    width: 640px;

    border-radius: 12px;

    box-shadow: 10px 14px 90px #F5AC6252;

}



.registration-container .registration-header{

    padding: 10px;



}

.registration-header h2{

    font-size: 20px;

    font-weight: 700;

}



.registration-header .divider{

    display: block;

    width: 15%;

    height: 5px;

    background: var(--accent-color);

    margin-top: 4px;

}



.registration-body .registration-box{

    position: relative;

    display: flex;

    flex-direction: row;

    flex-wrap: wrap;

    justify-content: space-around;

    padding: 10px 0px;

}



.registration-box .input-box{

    position: relative;

    width: 50%;

    justify-content: space-around;

    padding: 5px 10px;

    display: block;

}

.registration-box .input-box label{

    font-size: 14px;

    color: var(--secondary-color);

}



.registration-box .input-field{

    width: 100%;

    height: 36px;

    display: block;

    border-radius: 4px;

    border: 1px solid #1B1B1B46;

    padding-left: 8px;

}



.registration-box .input-field:focus{

    border-radius: 4px;

  transition: border 0.4s ease-in-out;
    outline: none;

    border: solid var(--accent-color);

    border-width: 1px 1px 3px 1px;

    padding-left: 8px;

    height: 40px;

    padding-top: 0px;

}



.registration-box .input-box:focus-within label{

    transition: display 0.4s ease-in-out;
    content: '';
    padding: 0 10px;

    margin-bottom: 15px;

}



.registration-box .input-box:focus-within{

    padding: 16px 10px;
  transition: 0.3s ease-in-out;
}

.registration-box .input-box:focus-within .input-field::placeholder{

    visibility: hidden;

  transition: 0.4s ease-in-out;
}



.registration-body .btn-register{

    border: 0;

    background: var(--accent-color);

    color: var(--primary-color);

    font-weight: 700;

    font-size: 16px;

    padding: 10px 25px;

    border-radius: 4px;

    box-shadow: 0px 4px 12px #F5AC6280;

    margin: 0px 10px;

    cursor: pointer;

}



.registration-body .btn-register:hover{

    background: var(--secondary-color);

  transition: 0.4s ease-in-out;
    box-shadow: 0px 4px 12px #231E1E90;

}



.registration-container .registration-footer{

    text-align: center;

    padding: 20px;

}



.registration-footer h3{

    font-size: 16px;

    font-weight: 500;

    color: var(--secondary-color);

}



.registration-footer a{

    color: var(--accent-color);

    text-decoration: none;

    font-weight: 700;

}



.registration-footer a:hover{

    border-bottom: 2px solid #FC8C1B;

} 




.calculator {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 1px solid #ccc;
            padding: 20px;
            background: #fff;
            z-index: 1000;
            width: 300px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .calculator input {
            width: 100%;
            margin-bottom: 10px;
            padding: 10px;
            font-size: 1.2em;
        }

        .calculator button {
          
            width: calc(25% - 10px);
            padding: 10px;
            font-size: 1.2em;
            margin: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
        }
.calculator-btn{
  border: 0;

    background: var(--secondary-color);
    color: var(--primary-color);

    font-weight: 700;

    font-size: 16px;

    padding: 10px 25px;

    border-radius: 4px;

    box-shadow: 0px 4px 12px #F5AC6280;

    margin: 5px 10px;

    cursor: pointer;

}
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }


@media screen and (max-width:480px){

    .registration-container{

        display: block;

        padding: 10px;

        border-radius: 12px;

        max-width: 400px;

    }

    .registration-container .registration-header{

        padding: 10px 0px;

    }

    .registration-body .registration-box{

        display: block;

    }

    .registration-box .input-box{

        width: 100%;

        padding: 05px 0px;

    }



    .registration-box .input-box:focus-within{

        padding: 12px 0px;

      transition: 0.4s ease-in-out;
    }

    .registration-body .btn-register{

        width: 100%;

        margin: auto;

    }

    .input-box {
                flex: 1 1 100%;
            }

            .calculator {
                width: 90%;
              height:50%;
                padding: 10px;
            }

            .calculator button {
                width: calc(23.33% - 10px);
                margin: 5px;
            }



}




  </style>
</head>
<body>
    <div class="registration-container">
        <iframe style="width: 100%;height: 600px;" src=""></iframe>
    </div>
    <div class="registration-container">
        <div class="registration-header">
            <h2>Registration UP Bank</h2>
            <span class="divider"></span>
        </div>
        <div class="registration-body">
            <form id="regi">
                <div class="registration-box">
                    <div class="input-box">
                        <label >Form URL</label>
                        <input type="text" class="input-field" id="formurl"placeholder="" required>
                    </div>
                    <div class="input-box">
                        <label >Sheet URL</label>
                        <input type="text" class="input-field" id="sheeturl"placeholder=""required>
                    </div>
                    <div  class="input-box">
                        <label >SheetID</label>
                        <input type="text" class="input-field" id="sheetid"placeholder=""required>
                    </div>
                    <div  class="input-box">
                        <label >Sheet GID</label>
                        <input type="text" class="input-field" id="sheetgid"placeholder=""required>
                    </div>
                    <div  class="input-box">
                        <label >FormID</label>
                        <input type="text" class="input-field" id="formid"placeholder=""required>
                    </div>
                    <div  class="input-box">
                        <label >Sdentry</label>
                        <input type="text" class="input-field" id="sd"placeholder=""required>
                    </div>
                    <div  class="input-box">
                        <label >Srentry</label>
                        <input type="text" class="input-field" id="sr"placeholder=""required>
                    </div>
                    <div class="input-box">
                        <label >Saentry</label>
                        <input type="text" class="input-field" id="sa"placeholder=""required>
                    </div>
                    <div class="input-box">
                        <label >Name</label>
                        <input type="text" class="input-field" id="name"placeholder=""required>
                    </div>
                    <div class="input-box">
                        <label >Land Area</label>
                        <input type="text" class="input-field" id="land"placeholder=""required>
                    </div>
                    <div class="input-box">
                        <label >Phone Number</label>
                        <input type="text" class="input-field" id="phone"placeholder=""required>
                    </div>
                    <div class="input-box">
                        <label >Email</label>
                        <input type="text" class="input-field" id="email"placeholder=""required>
                    </div>
                    <div class="input-box">
                        <label >Will Deposit of Total</label>
                        <input type="text" class="input-field" id="wdt"placeholder=""required>
                    </div>
                    <div class="input-box">
                        <label >Initial Deposit</label>
                        <input type="text" class="input-field" id="ind"placeholder=""required>
                    </div>
                    
                </div>
                <button class="btn-register" id="btn-register">Register Now</button>
<p id="result"></p>
            </form>
        </div>
        <div class="registration-footer">
            <h3>Start Auto Value the Input <button style="display: none;" class="calculator-btn"id="calculate">Auto ENTRY</button><button class="calculator-btn"id="calculate2">Auto ID</button></h3>
           <h3>Owner list sheet <a href="https://docs.google.com/spreadsheets/d/1Bp3NBLwOvw3KJ6znz47s1mhbC5phzHSVP9O3_i1ydUQ/edit?gid=1664436013#gid=1664436013" target="_blank">here</a></h3>
        </div>
    </div>
    <script>
document.getElementById('calculate').addEventListener('click', async function(event) {
    event.preventDefault();

    const formId = document.getElementById('formid').value;
    try {
        const response = await fetch(`https://docs.google.com/forms/d/e/${formId}/viewform`, { mode: 'no-cors' });
        
        // Check if response is OK or fetch another way to get the data if no-cors fails
        if (response && response.ok) {
            const formHTML = await response.text();
            const regex = /FB_PUBLIC_LOAD_DATA_ = (.*?);<\/script>/;
            const match = regex.exec(formHTML);

            if (match && match[1]) {
                const fbPublicLoadData = JSON.parse(match[1]);
                const descriptionNumber = fbPublicLoadData[1][1][0][4][0][0];
                const reasonNumber = fbPublicLoadData[1][1][1][4][0][0];
                const amountNumber = fbPublicLoadData[1][1][2][4][0][0];

                document.getElementById("sd").value = descriptionNumber;
                document.getElementById("sr").value = reasonNumber;
                document.getElementById("sa").value = amountNumber;
            } else {
                document.getElementById("result").textContent = 'FB_PUBLIC_LOAD_DATA_ not found!';
            }
        } else {
            document.getElementById("result").textContent = 'Failed to fetch form data due to CORS or form access restrictions!';
        }
    } catch (error) {
        document.getElementById("result").textContent = 'Error fetching or processing the form data!';
    }
});

document.getElementById('calculate2').addEventListener('click', async function(e) {
    e.preventDefault();
    document.getElementById("calculate2").style.display = 'none';
    document.getElementById("calculate").style.display = 'block';

    const sheetUrl = document.getElementById('sheeturl').value;
    const formUrl = document.getElementById('formurl').value;

    const idRegexSheet = /\/d\/([a-zA-Z0-9_-]+)/;
    const gidRegex = /gid=([0-9]+)/;
    const sheetIdMatch = sheetUrl.match(idRegexSheet);
    const gidMatch = sheetUrl.match(gidRegex);

    const sheetId = sheetIdMatch ? sheetIdMatch[1] : "Not found";
    const sheetGid = gidMatch ? gidMatch[1] : "Not found";

    document.getElementById('sheetid').value = sheetId;
    document.getElementById('sheetgid').value = sheetGid;

    const idRegexForm = /\/e\/([a-zA-Z0-9_-]+)/;
    const formIdMatch = formUrl.match(idRegexForm);
    const formId = formIdMatch ? formIdMatch[1] : "Not found";
    document.getElementById('formid').value = formId;
});

document.getElementById('btn-register').addEventListener('click', function() {
    // Gather input values
    const name = document.getElementById('name').value;
    const land = document.getElementById('land').value;
    const phone = document.getElementById('phone').value;
    const email = document.getElementById('email').value;
    const state = "Waiting";
    const sheetId = document.getElementById('sheetid').value;
    const sheetGid = document.getElementById('sheetgid').value;
    const formId = document.getElementById('formid').value;
    const sd = document.getElementById('sd').value;
    const sr = document.getElementById('sr').value;
    const sa = document.getElementById('sa').value;
    const ind = document.getElementById('ind').value;
    const wdt = document.getElementById('wdt').value;

    // Define calculated fields
    const ts = '=SUM(D3:D100,0)';
    const rst = '=SUM(D3:D100,">0")';
    const cst = '=SUM(D3:D100,"<0")';

    // Define Google Form URLs
    const formUrl1 = `https://docs.google.com/forms/d/e/${formId}/formResponse`;
    const formUrl2 = 'https://docs.google.com/forms/d/e/1FAIpQLSeyFCS4ytlUQsaM6EkGUbWvvYoIUiadSslL6x065zcqGDNrMw/formResponse';

    // Prepare first form data submission to formUrl2
    const formData1 = new FormData();
    formData1.append('entry.890999944', name);
    formData1.append('entry.696253293', land);
    formData1.append('entry.1220953509', phone);
    formData1.append('entry.315450195', email);
    formData1.append('entry.1604063136', state);
    formData1.append('entry.189558853', sheetId);
    formData1.append('entry.2104162461', sheetGid);
    formData1.append('entry.2031665051', formId);
    formData1.append('entry.1199415050', sd);
    formData1.append('entry.828373213', sr);
    formData1.append('entry.1358821049', sa);

    fetch(formUrl2, {
        method: 'POST',
        body: formData1,
        mode: 'no-cors'
    });

    // Prepare second form data submission to formUrl1 with calculated fields
    const formData2 = new FormData();
    formData2.append(`entry.${sd}`, ts);
    formData2.append(`entry.${sr}`, rst);
    formData2.append(`entry.${sa}`, cst);

    fetch(formUrl1, {
        method: 'POST',
        body: formData2,
        mode: 'no-cors'
    });

    // Prepare third form data submission to formUrl1 with additional fields
    const formData3 = new FormData();
    formData3.append(`entry.${sd}`, "New Contact");
    formData3.append(`entry.${sr}`, wdt);
    formData3.append(`entry.${sa}`, ind);

    fetch(formUrl1, {
        method: 'POST',
        body: formData3,
        mode: 'no-cors'
    })
    .then(() => {
        alert('Form submitted successfully.');
        location.reload();
    })
    .catch(error => {
        console.error('Error submitting form:', error);
    });
});
    </script>
</body>
  </html>
